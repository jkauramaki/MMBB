<!DOCTYPE html>
<html>
  <head>
    <title>MMBB batery</title>
    <script src="./jspsych/dist/graphFunction.js"> </script>
    <script src="./jspsych/dist/jspsych.js"></script>
    <script src="./jspsych/dist/plugin-html-button-response.js"></script>
    <script src="./jspsych/dist/plugin-audio-keyboard-response.js"></script>
    <script src="./jspsych/dist/plugin-audio-button-response.js"> </script>
    <script src="./jspsych/dist/plugin-html-button-response.js"> </script>
    <script src="./jspsych/dist/plugin-instructions.js"> </script>
    <script src="./jspsych/dist/plugin-survey-likert.js"> </script>
    <script src="./jspsych/dist/plugin-canvas-button-response.js"> </script>
    <script src="./jspsych/dist/extension-accelerometer.js"> </script>
    <script src="./jspsych/dist/plugin-html-keyboard-response.js"> </script>
    <script src="./jspsych/dist/plugin-survey-multi-choice.js"> </script>
    <script src="./jspsych/dist/plugin-initialize-microphone.js"> </script>
    <script src="./jspsych/dist/plugin-html-audio-response.js"> </script>
    <script src="./jspsych/dist/plugin-html-slider-response.js"> </script>
    <link href="https://unpkg.com/jspsych@7.2.1/css/jspsych.css" rel="stylesheet" type="text/css" /> 
    <link rel="stylesheet" href="../batteries/generalCSS.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

  </head>
  <body></body>
  <script>

    var jsPsych = initJsPsych({
      extensions: [
        {type: jsPsychExtensionAccelerometer }
      ],
      show_progress_bar: true,
      on_finish: function() {
        jsPsych.data.get().localSave('csv','dataEmoENGPart1.csv');
      }
    });

    var instruction = {
        type: jsPsychInstructions,
        pages: [
        '<p style="font-size:7vw;">Welcome MMBB batery.</p>',
        '<p style="font-size:7vw;">Emotion task</p>',
        ],
        button_label_next: "Next",
        button_label_previous: "Previous",
        show_clickable_nav: true
    }

    var images = [
      { img: "./basic_emoji/v1a1.png",  type: 'Sad'},
      { img: "./basic_emoji/v1a5.png",  type: 'Anger'},
      { img: "./basic_emoji/v5a1.png",  type: 'Tender'},
      { img: "./basic_emoji/v5a5.png",  type: 'Happy'}
    ];

    stim_dur = 15500

    var t1_1Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/092.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t1_1Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: [images[1], images[2]],
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '1',condition: 'angry',correct_response: 0},
      post_trial_gap: 1000
    };
    
    const t1_1 = {
        timeline: [t1_1Stim, t1_1Resp]
    }
     
    var t1_2Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/033.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t1_2Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: [images[0], images[3]],
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '2',condition: 'sad',correct_response: 0},
      post_trial_gap: 1000
    };
    
    const t1_2 = {
        timeline: [t1_2Stim, t1_2Resp]
    }
    var t1_3Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/023.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t1_3Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: [images[1], images[3]],
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '3',condition: 'happy',correct_response: 0},
      post_trial_gap: 1000
    };
    
    const t1_3 = {
        timeline: [t1_3Stim, t1_3Resp]
    }
    var t1_4Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/105.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t1_4Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: [images[2], images[3]],
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '4',condition: 'happy',correct_response: 1},
      post_trial_gap: 1000
    };
    
    const t1_4 = {
        timeline: [t1_4Stim, t1_4Resp]
    }

    var t1_5Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/106.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t1_5Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: [images[0], images[2]],
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '5',condition: 'tender',correct_response: 0},
      post_trial_gap: 1000
    };
    
    const t1_5 = {
        timeline: [t1_5Stim, t1_5Resp]
    }
    var t1_6Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/109.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t1_6Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: [images[0], images[1]],
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '6',condition: 'sad',correct_response: 1},
      post_trial_gap: 1000
    };
    
    const t1_6 = {
        timeline: [t1_6Stim, t1_6Resp]
    }

    const randomTrials2Responses = {
        timeline: jsPsych.randomization.shuffle([t1_1, t1_2,t1_3,t1_4,t1_5,t1_6])
    }

    var instruction2 = {
        type: jsPsychInstructions,
        pages: [
        '<p style="font-size:7vw;">Now the task is repeated</p>',
        ],
        button_label_next: "Next",
        show_clickable_nav: true
    }

    var t2_1Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/001.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_1Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '7',condition: 'happy',correct_response: 3},
      post_trial_gap: 1000
    };
    
    const t2_1 = {
        timeline: [t2_1Stim, t2_1Resp]
    }

    var t2_2Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/003.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_2Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '8',condition: 'sad',correct_response: 0},
      post_trial_gap: 1000
    };

    const t2_2 = {
        timeline: [t2_2Stim, t2_2Resp]
    }

    var t2_3Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/081.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_3Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '9',condition: 'happy',correct_response: 1},
      post_trial_gap: 1000
    };
    
    const t2_3 = {
        timeline: [t2_3Stim, t2_3Resp]
    }
     
    var t2_4Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/084.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_4Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
      button_html: '<img src="%choice%" />',
      data: {type: '10',condition: 'happy',correct_response: 1},
      post_trial_gap: 1000
    };
    
    const t2_4 = {
        timeline: [t2_4Stim, t2_4Resp]
    }
    var t2_5Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/075.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_5Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '11',condition: 'tender',correct_response: 1},
      post_trial_gap: 1000
    };
    
    const t2_5 = {
        timeline: [t2_5Stim, t2_5Resp]
    }
    var t2_6Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/024.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_6Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '12',condition: 'sad',correct_response: 0},
      post_trial_gap: 1000
    };
    
    const t2_6 = {
        timeline: [t2_6Stim, t2_6Resp]
    }

    var t2_7Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/042.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_7Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '13',condition: 'tender',correct_response: 1},
      post_trial_gap: 1000
    };
    
    const t2_7 = {
        timeline: [t2_7Stim, t2_7Resp]
    }
    var t2_8Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/107.mp3',
        prompt: '<p style="font-size:45px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    const t2_8Resp = {
      type: jsPsychHtmlButtonResponse,
    	choices: images,
      stimulus: "Which emotion does this music represent?",
    	button_html: '<img src="%choice%" />',
      data: {type: '14',condition: 'sad',correct_response: 0},
      post_trial_gap: 1000
    };
    
    const t2_8 = {
        timeline: [t2_8Stim, t2_8Resp]
    }


    const randomTrialsFullResponses = {
        timeline: jsPsych.randomization.shuffle([t2_1, t2_2,t2_3,t2_4,t2_5,t2_6,t2_7,t2_8])
    }

    var instruction3 = {
        type: jsPsychInstructions,
        pages: [
        '<p style="font-size:7vw;">Emotion task Part 2</p>',
        ],
        button_label_next: "Next",
        button_label_previous: "Previous",
        show_clickable_nav: true
    }

    var instruction4 = {
        type: jsPsychInstructions,
        pages: [
        '<p style="font-size:30px;">Please rate the emotional content of the music</p>',
        ],
        button_label_next: "Next",
        button_label_previous: "Previous",
        show_clickable_nav: true
    }

    var t3_1Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/002.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var t3_2Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/005.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var t3_3Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/034.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var t3_4Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/088.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }
    var t3_5Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/071.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var t3_6Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/079.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var t3_7Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/043.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var t3_8Stim = {
        type: jsPsychAudioKeyboardResponse,
        stimulus: './final_stimuli/044.mp3',
        prompt: '<p style="font-size:30px;">Listen to the music</p>',
        trial_duration: stim_dur,
        choices: ["NO_KEYS"],
    }

    var part2_scales = {
    type: jsPsychHtmlSliderResponse,
    stimulus: ['Mood', 'Energy', 'How strong are the emotions expressed by the music?','How much did you like/dislike the music?','How familiar did the music sound to you?'],
    nSliders: 5,
    require_movement: true,
    slider_width: 250,
    labels: [['Negative', 'Neutral','Positive'],['Low Energy', 'High Energy'],
    ['Low intensity', 'High intensity'],['Strongly dislike','Neutral','Strongly like'],['Very unfamiliar','Very familiar']],
    prompt: 'Please rate the emotional content of the music'
    };
    
    const t3_1 = {
        timeline: [t3_1Stim, part2_scales]
    }

    const t3_2 = {
        timeline: [t3_2Stim, part2_scales]
    }

    const t3_3 = {
        timeline: [t3_3Stim, part2_scales]
    }

    const t3_4 = {
        timeline: [t3_4Stim, part2_scales]
    }

    const t3_5 = {
        timeline: [t3_5Stim, part2_scales]
    }

    const t3_6 = {
        timeline: [t3_6Stim, part2_scales]
    }

    const t3_7 = {
        timeline: [t3_7Stim, part2_scales]
    }

    const t3_8 = {
        timeline: [t3_8Stim, part2_scales]
    }

    const randomPart2Trials = {
        timeline: jsPsych.randomization.shuffle([t3_1, t3_2,t3_3,t3_4,t3_5, t3_6,t3_7,t3_8])
    }
    
    jsPsych.run([instruction, randomTrials2Responses, instruction2, randomTrialsFullResponses,instruction3, instruction4, randomPart2Trials]);


 </script>
</html>
